#

import requests
import re


banner ="""
   ___          __      ____    ___   _   __          _____   ___    ___    ___  
  / __\/\   /\ /__\    |___ \  / _ \ / | / /_        |___ /  / _ \  ( _ )  ( _ ) 
 / /   \ \ / //_\ _____  __) || | | || || '_ \  _____  |_ \ | | | | / _ \  / _ \ 
/ /___  \ V ///__|_____|/ __/ | |_| || || (_) ||_____|___) || |_| || (_) || (_) |
\____/   \_/ \__/      |_____| \___/ |_| \___/       |____/  \___/  \___/  \___/                                                                             
"""

print(banner)
host = input("Set Host IP = ")
header = {
    'Connection': 'close'

}
file_server = str('http://' + host + ':8161/fileserver')
api = str('http://' + host + ':8161/api')
admin_ = str('http://' + host + ':8161/admin')


def sendPoc():
    req = requests.get(file_server, None)
    if (bytes("disabled", 'UTF-8') not in req.content) & (bytes("file access.", 'UTF-8') in req.content):
        print("\n[Info]fileserver Detected!\n")
        req = requests.get(api, auth=('admin', 'admin'))
        if bytes('Directory: /api/', 'UTF-8') in req.content:
            print("[Info]Weak password Detected!\n")
            req = requests.get(admin_, auth=('admin', 'admin'))
            html = str(req.content, 'UTF-8')
            version = re.search('5\.\d+\.\d+',html).group()
            print('[Info]ActiveMQ version:' + version+'\n')
            print("It seems like  host is vulnerable")
            exit()
        else:
            print("[Waring]Host is NOT VULNERABLE!!")
    else:
        print('[Waring]CAN NOT access fileserver!!\n[Waring]Host is NOT VULNERABLE!!')

    sendPoc()
